<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Copy_1_of_FSM_Showlivelocation</name>
        <label>Copy 1 of FSM_Showlivelocation</label>
        <locationX>402</locationX>
        <locationY>4020</locationY>
        <actionName>FSM_permissionsetgroupassign</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Has_location_been_updated_and_SR_is_technician</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>assignPsg</name>
            <value>
                <elementReference>assignPsg</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>permissionSetGroupId</name>
            <value>
                <elementReference>PsgId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>removePsg</name>
            <value>
                <elementReference>removePsg</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>userId</name>
            <value>
                <elementReference>$Record.RelatedRecordId</elementReference>
            </value>
        </inputParameters>
        <nameSegment>FSM_permissionsetgroupassign</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>FSM_Showlivelocation</name>
        <label>FSM_Showlivelocation</label>
        <locationX>138</locationX>
        <locationY>4020</locationY>
        <actionName>FSM_permissionsetgroupassign</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Has_location_been_updated_and_SR_is_technician</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>assignPsg</name>
            <value>
                <elementReference>assignPsg</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>permissionSetGroupId</name>
            <value>
                <elementReference>PsgId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>removePsg</name>
            <value>
                <elementReference>removePsg</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>userId</name>
            <value>
                <elementReference>$Record.RelatedRecordId</elementReference>
            </value>
        </inputParameters>
        <nameSegment>FSM_permissionsetgroupassign</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <apiVersion>57.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <description>SFL-887</description>
        <name>Add_TimeSheetShare</name>
        <label>Add TimeSheetShare</label>
        <locationX>242</locationX>
        <locationY>1548</locationY>
        <assignmentItems>
            <assignToReference>SingleTSShareRecord.RowCause</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Manual</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SingleTSShareRecord.ParentId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_AllTimeSheet.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SingleTSShareRecord.UserOrGroupId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>NewGroupID.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SingleTSShareRecord.AccessLevel</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Edit</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>TimeSheetShareList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>SingleTSShareRecord</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_AllTimeSheet</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_BU</name>
        <label>Assign BU</label>
        <locationX>2068</locationX>
        <locationY>492</locationY>
        <assignmentItems>
            <assignToReference>Get_SR.FSM_BusinessUnit__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_SR.ServiceCrew.FSM_ServiceTerritory__r.FSM_BusinessUnit__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_record</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assignment_for_false</name>
        <label>Assignment for false</label>
        <locationX>402</locationX>
        <locationY>3912</locationY>
        <assignmentItems>
            <assignToReference>assignPsg</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>removePsg</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Copy_1_of_FSM_Showlivelocation</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assignment_for_true</name>
        <label>Assignment for true</label>
        <locationX>138</locationX>
        <locationY>3912</locationY>
        <assignmentItems>
            <assignToReference>assignPsg</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>removePsg</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>FSM_Showlivelocation</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>SFL-887</description>
        <name>Collect_AllTImeSheetID</name>
        <label>Collect AllTImeSheetID</label>
        <locationX>638</locationX>
        <locationY>600</locationY>
        <assignmentItems>
            <assignToReference>AllTimeSheetID</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_to_Collect_AllTimeSheetID.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_to_Collect_AllTimeSheetID</targetReference>
        </connector>
    </assignments>
    <decisions>
        <description>SFL-887</description>
        <name>Check_AllTimeSheet_record_found</name>
        <label>Check AllTimeSheet record found</label>
        <locationX>550</locationX>
        <locationY>792</locationY>
        <defaultConnector>
            <targetReference>Is_New_Joiner</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Record_Found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_AllTimeSheet</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>FWBUGroupName</targetReference>
            </connector>
            <label>Record Found</label>
        </rules>
    </decisions>
    <decisions>
        <description>SFL-887</description>
        <name>Check_FSM_BusinessUnit_c_Updated</name>
        <label>Check FSM_BusinessUnit__c Updated</label>
        <locationX>836</locationX>
        <locationY>276</locationY>
        <defaultConnector>
            <targetReference>Is_New_Joiner</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_BU_Updated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FSM_BusinessUnit__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_BusinessUnit__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_AllTimeSheet</targetReference>
            </connector>
            <label>Yes BU Updated</label>
        </rules>
    </decisions>
    <decisions>
        <description>SFI-683
Updated as part of SFI-2934</description>
        <name>Check_if_Address_WorkCenter_TravelPolicy_BU_get_updated</name>
        <label>Check if Address-WorkCenter-TravelPolicy-BU get updated</label>
        <locationX>1100</locationX>
        <locationY>2364</locationY>
        <defaultConnector>
            <targetReference>Is_Duration_capacity_or_Travel_restriction_updated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Nothing Updated</defaultConnectorLabel>
        <rules>
            <name>Yes_One_of_the_field_get_updated</name>
            <conditionLogic>(((1 OR 2 OR 3 OR 4 OR 5 OR 6 OR 7 OR 8) AND 9) OR 9 OR 11 ) AND 10</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FSM_City__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.FSM_City__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_Street__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.FSM_Street__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_County__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.FSM_County__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_Country__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.FSM_Country__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_PostCode__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.FSM_PostCode__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_WorkCentreExternalId__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.FSM_WorkCentreExternalId__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_BusinessUnit__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.FSM_BusinessUnit__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_BaseLocation__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.FSM_BaseLocation__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_STMEffectiveDate__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.FSM_STMEffectiveDate__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_STMEffectiveDate__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_LeavingDate__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.FSM_LeavingDate__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Call_STM_Record_Creation_1</targetReference>
            </connector>
            <label>Yes One of the field get updated</label>
        </rules>
        <rules>
            <name>Work_Center_updated_but_not_Effective_date</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FSM_WorkCentreExternalId__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_STMEffectiveDate__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>$Record__Prior.FSM_STMEffectiveDate__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Call_error_log</targetReference>
            </connector>
            <label>Work Center updated but not Effective date</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_permission_set_group_to_be_removed_is_present</name>
        <label>Check if permission set group to be removed is present</label>
        <locationX>534</locationX>
        <locationY>3804</locationY>
        <defaultConnector>
            <targetReference>Has_location_been_updated_and_SR_is_technician</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>PSG not assigned</defaultConnectorLabel>
        <rules>
            <name>PSG_assigned_to_user</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Psag_Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assignment_for_false</targetReference>
            </connector>
            <label>PSG assigned to user</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_PSG_already_assigned</name>
        <label>Check if PSG already assigned</label>
        <locationX>50</locationX>
        <locationY>3804</locationY>
        <defaultConnector>
            <targetReference>Assignment_for_true</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not assigned</defaultConnectorLabel>
        <rules>
            <name>Already_present</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Psag_Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Has_location_been_updated_and_SR_is_technician</targetReference>
            </connector>
            <label>Already present</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_record_updated_or_Created</name>
        <label>Check if record updated or Created</label>
        <locationX>836</locationX>
        <locationY>3264</locationY>
        <defaultConnector>
            <targetReference>Is_location_given_on_SA_and_SR_is_technician</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Record Created</defaultConnectorLabel>
        <rules>
            <name>Record_updated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ISNEW</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Show_Live_Location_updated</targetReference>
            </connector>
            <label>Record updated</label>
        </rules>
    </decisions>
    <decisions>
        <description>SFS-7832</description>
        <name>Crew_BU_is_null</name>
        <label>Crew BU is null</label>
        <locationX>2200</locationX>
        <locationY>384</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Add_BU_for_Crew</name>
            <conditionLogic>(1 OR 2) AND 3</conditionLogic>
            <conditions>
                <leftValueReference>Get_SR.FSM_BusinessUnit__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_SR.FSM_BusinessUnit__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_SR.ResourceType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>C</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_BU</targetReference>
            </connector>
            <label>Add BU for crew</label>
        </rules>
    </decisions>
    <decisions>
        <description>Created as a part of SFS-3053</description>
        <name>Has_location_been_updated_and_SR_is_technician</name>
        <label>Has location been updated and SR is technician?</label>
        <locationX>567</locationX>
        <locationY>4380</locationY>
        <defaultConnectorLabel>Location isn&apos;t updated and SR isn&apos;t technician</defaultConnectorLabel>
        <rules>
            <name>Location_updated_and_SR_is_technician</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.LocationId</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ResourceType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>T</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Has_location_changed_to_null</targetReference>
            </connector>
            <label>Location updated and SR is technician</label>
        </rules>
    </decisions>
    <decisions>
        <description>Created as a part of SFS-3053</description>
        <name>Has_location_changed_to_null</name>
        <label>Has location changed to null?</label>
        <locationX>413</locationX>
        <locationY>4488</locationY>
        <defaultConnector>
            <targetReference>Loop_Location_and_Parent</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Location Not Null</defaultConnectorLabel>
        <rules>
            <name>Location_Changed_to_Null</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.LocationId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.LocationId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Copy_1_of_Loop_Location_and_Parent</targetReference>
            </connector>
            <label>Location Changed to Null</label>
        </rules>
    </decisions>
    <decisions>
        <description>SFI-2934
SFS-8516</description>
        <name>Is_Duration_capacity_or_Travel_restriction_updated</name>
        <label>Is Duration capacity  or Travel restriction updated</label>
        <locationX>836</locationX>
        <locationY>2748</locationY>
        <defaultConnector>
            <targetReference>Get_Location_and_Parent</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not updated</defaultConnectorLabel>
        <rules>
            <name>Yes_updated</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FSM_CustomerAppointmentDurationCapacity__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_TravelRestriction__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Service_Territory_Member</targetReference>
            </connector>
            <label>Yes updated</label>
        </rules>
    </decisions>
    <decisions>
        <description>SFS-155</description>
        <name>Is_Group_member_available</name>
        <label>Is Group member available</label>
        <locationX>1672</locationX>
        <locationY>492</locationY>
        <defaultConnectorLabel>No Group member</defaultConnectorLabel>
        <rules>
            <name>Group_Member_present</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_group_Member</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Delete_group_member</targetReference>
            </connector>
            <label>Group Member present</label>
        </rules>
    </decisions>
    <decisions>
        <description>Created as part of SFS-3053</description>
        <name>Is_location_given_on_SA_and_SR_is_technician</name>
        <label>Is location given on SA and SR is technician?</label>
        <locationX>1106</locationX>
        <locationY>3372</locationY>
        <defaultConnectorLabel>Location Not Given or SR isn&apos;t technician</defaultConnectorLabel>
        <rules>
            <name>Location_Given_and_SR_is_technician</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.LocationId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ResourceType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>T</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_Location_and_Parent</targetReference>
            </connector>
            <label>Location Given and SR is technician</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_New_Joiner</name>
        <label>Is New Joiner</label>
        <locationX>836</locationX>
        <locationY>2256</locationY>
        <defaultConnector>
            <targetReference>Check_if_Address_WorkCenter_TravelPolicy_BU_get_updated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FSM_JoiningDate__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_JoiningDate__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_WorkCentreExternalId__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Call_STM_Record_Creation</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Show_Live_Location_updated</name>
        <label>Show Live Location updated?</label>
        <locationX>567</locationX>
        <locationY>3372</locationY>
        <defaultConnector>
            <targetReference>Has_location_been_updated_and_SR_is_technician</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Is_Show_Live_Location_updated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.FSM_ShowLiveLocation__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Permission_set_group_id</targetReference>
            </connector>
            <label>Is Show Live Location updated</label>
        </rules>
    </decisions>
    <decisions>
        <name>Show_live_location_value</name>
        <label>Show live location value</label>
        <locationX>292</locationX>
        <locationY>3696</locationY>
        <defaultConnector>
            <targetReference>Check_if_permission_set_group_to_be_removed_is_present</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>true to false</defaultConnectorLabel>
        <rules>
            <name>False_to_true</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.FSM_ShowLiveLocation__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.FSM_ShowLiveLocation__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_if_PSG_already_assigned</targetReference>
            </connector>
            <label>False to true</label>
        </rules>
    </decisions>
    <description>Created as part of SFS-139, This will run After record created and updated
Updated As part of SFS-35
Updated As part of SFS-305
Updated As part of SFS-155
Updated as part of SFS-1793
Updated as part of SFS-3053
Updated as part of SFS-3013
Updated as part of SFI-701
Updated As part of SFI-683
updated as part of SFS-5308
updated as part of sfs-5475
Updated as part of SFS-7170
Updated as part of SFI-2934
Updated as part of SFS-7832
Updated as part of SFS-8516
Updated as part of SFL-633
Updated as part of SFL-887
Updated as part of SFL-1179</description>
    <environments>Default</environments>
    <formulas>
        <name>Addressisupdated</name>
        <dataType>Boolean</dataType>
        <expression>OR(
{!$Record.FSM_City__c}!={!$Record__Prior.FSM_City__c}, 
{!$Record.FSM_Street__c}!={!$Record__Prior.FSM_Street__c},
{!$Record.FSM_Country__c}!={!$Record__Prior.FSM_Country__c},
{!$Record.FSM_County__c}!={!$Record__Prior.FSM_County__c},
{!$Record.FSM_PostCode__c}!={!$Record__Prior.FSM_PostCode__c}
)</expression>
    </formulas>
    <formulas>
        <description>SFS-139</description>
        <name>ISNEW</name>
        <dataType>Boolean</dataType>
        <expression>ISNEW()</expression>
    </formulas>
    <formulas>
        <name>LeavingDateisUpdated</name>
        <dataType>Boolean</dataType>
        <expression>OR(ISBLANK({!$Record__Prior.FSM_LeavingDate__c}),
{!$Record.FSM_LeavingDate__c}!={!$Record__Prior.FSM_LeavingDate__c}
)</expression>
    </formulas>
    <formulas>
        <name>WCorBUisUpdated</name>
        <dataType>Boolean</dataType>
        <expression>OR(
{!$Record.FSM_WorkCentreExternalId__c}!={!$Record__Prior.FSM_WorkCentreExternalId__c},
ISCHANGED({!$Record.FSM_BusinessUnit__c})
)</expression>
    </formulas>
    <interviewLabel>FSM Service Resource - AfterTrigger {!$Flow.CurrentDateTime}</interviewLabel>
    <label>FSM Service Resource - AfterTrigger</label>
    <loops>
        <description>Created as a part of SFS-3053</description>
        <name>Copy_1_of_Loop_Location_and_Parent</name>
        <label>Copy 1 of Loop Location and Parent</label>
        <locationX>281</locationX>
        <locationY>4596</locationY>
        <collectionReference>LocationAndParentLocation</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Remove_Location_Sharing</targetReference>
        </nextValueConnector>
    </loops>
    <loops>
        <description>SFL-887</description>
        <name>Loop_AllTimeSheet</name>
        <label>Loop AllTimeSheet</label>
        <locationX>154</locationX>
        <locationY>1440</locationY>
        <collectionReference>Get_AllTimeSheet</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_TimeSheetShare</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_TimeSheetShare</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Created as a part of SFS-3053</description>
        <name>Loop_Location_and_Parent</name>
        <label>Loop Location and Parent</label>
        <locationX>836</locationX>
        <locationY>5256</locationY>
        <collectionReference>LocationAndParentLocation</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Location_Sharing</targetReference>
        </nextValueConnector>
    </loops>
    <loops>
        <description>SFL-887</description>
        <name>Loop_to_Collect_AllTimeSheetID</name>
        <label>Loop to Collect AllTimeSheetID</label>
        <locationX>550</locationX>
        <locationY>492</locationY>
        <collectionReference>Get_AllTimeSheet</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Collect_AllTImeSheetID</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Check_AllTimeSheet_record_found</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <description>Created as part of SFS-3053</description>
        <name>Add_Location_Sharing</name>
        <label>Add Location Sharing</label>
        <locationX>924</locationX>
        <locationY>5364</locationY>
        <connector>
            <targetReference>Loop_Location_and_Parent</targetReference>
        </connector>
        <inputAssignments>
            <field>AccessLevel</field>
            <value>
                <stringValue>Read</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ParentId</field>
            <value>
                <elementReference>Loop_Location_and_Parent.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UserOrGroupId</field>
            <value>
                <elementReference>$Record.RelatedRecordId</elementReference>
            </value>
        </inputAssignments>
        <object>LocationShare</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <description>SFL-887</description>
        <name>Create_TimeSheetShare</name>
        <label>Create TimeSheetShare</label>
        <locationX>154</locationX>
        <locationY>1740</locationY>
        <connector>
            <targetReference>Is_New_Joiner</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Call_error_log_Create</targetReference>
        </faultConnector>
        <inputReference>TimeSheetShareList</inputReference>
    </recordCreates>
    <recordDeletes>
        <description>SFS-155</description>
        <name>Delete_group_member</name>
        <label>Delete group member</label>
        <locationX>1540</locationX>
        <locationY>600</locationY>
        <inputReference>Get_group_Member</inputReference>
    </recordDeletes>
    <recordDeletes>
        <description>SFL-887</description>
        <name>Delete_Old_TS_Shared_record</name>
        <label>Delete Old TS Shared record</label>
        <locationX>154</locationX>
        <locationY>1332</locationY>
        <connector>
            <targetReference>Loop_AllTimeSheet</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Call_error_log_Del</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>UserOrGroupId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>OldGroupID.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>ParentId</field>
            <operator>In</operator>
            <value>
                <elementReference>AllTimeSheetID</elementReference>
            </value>
        </filters>
        <object>TimeSheetShare</object>
    </recordDeletes>
    <recordDeletes>
        <description>Created as a part of SFS-3053</description>
        <name>Remove_Location_Sharing</name>
        <label>Remove Location Sharing</label>
        <locationX>369</locationX>
        <locationY>4704</locationY>
        <connector>
            <targetReference>Copy_1_of_Loop_Location_and_Parent</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ParentId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Copy_1_of_Loop_Location_and_Parent.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>UserOrGroupId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.RelatedRecordId</elementReference>
            </value>
        </filters>
        <filters>
            <field>AccessLevel</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Read</stringValue>
            </value>
        </filters>
        <object>LocationShare</object>
    </recordDeletes>
    <recordLookups>
        <description>SFL-887</description>
        <name>FWBUGroupName</name>
        <label>FWBUGroupName</label>
        <locationX>154</locationX>
        <locationY>900</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>FWBUGroupNameOld</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>FSM_BusinessUnit__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.FSM_BusinessUnit__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>FSM_IsActive__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>FSM_BusinessUnitToPublicGroupMap__mdt</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>SFL-887</description>
        <name>FWBUGroupNameOld</name>
        <label>FWBUGroupNameOld</label>
        <locationX>154</locationX>
        <locationY>1008</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>NewGroupID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>FSM_BusinessUnit__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record__Prior.FSM_BusinessUnit__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>FSM_IsActive__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>FSM_BusinessUnitToPublicGroupMap__mdt</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>SFL-887</description>
        <name>Get_AllTimeSheet</name>
        <label>Get AllTimeSheet</label>
        <locationX>550</locationX>
        <locationY>384</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_to_Collect_AllTimeSheetID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ServiceResourceId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>StartDate</field>
            <operator>GreaterThanOrEqualTo</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>TimeSheet</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>SFS-155</description>
        <name>Get_Group</name>
        <label>Get Group</label>
        <locationX>1672</locationX>
        <locationY>276</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_group_Member</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.FSM_Service_Territory_Member_Deletion__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Group</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>SFS-155</description>
        <name>Get_group_Member</name>
        <label>Get group Member</label>
        <locationX>1672</locationX>
        <locationY>384</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_Group_member_available</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>GroupId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Group.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>UserOrGroupId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.RelatedRecordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>GroupMember</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Created as part of SFS-3053</description>
        <name>Get_Location_and_Parent</name>
        <label>Get Location and Parent</label>
        <locationX>836</locationX>
        <locationY>3048</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Product_Items</targetReference>
        </connector>
        <filterLogic>or</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.LocationId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Location.ParentLocationId</elementReference>
            </value>
        </filters>
        <object>Location</object>
        <outputReference>LocationAndParentLocation</outputReference>
        <queriedFields>Id</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_Permission_Set_Assignment_for_User</name>
        <label>Get Permission Set Assignment for User</label>
        <locationX>292</locationX>
        <locationY>3588</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Show_live_location_value</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AssigneeId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.RelatedRecordId</elementReference>
            </value>
        </filters>
        <filters>
            <field>PermissionSetGroupId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>PsgId</elementReference>
            </value>
        </filters>
        <object>PermissionSetAssignment</object>
        <outputAssignments>
            <assignToReference>Psag_Id</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Get_Permission_set_group_id</name>
        <label>Get Permission set group id</label>
        <locationX>292</locationX>
        <locationY>3480</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Permission_Set_Assignment_for_User</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>FSM_AppointmentAssistantGroup</stringValue>
            </value>
        </filters>
        <object>PermissionSetGroup</object>
        <outputAssignments>
            <assignToReference>PsgId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <description>Created as a part of SFS-3013</description>
        <name>Get_Product_Items</name>
        <label>Get Product Items</label>
        <locationX>836</locationX>
        <locationY>3156</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_if_record_updated_or_Created</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>LocationId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.LocationId</elementReference>
            </value>
        </filters>
        <object>ProductItem</object>
        <outputReference>ProductItems</outputReference>
        <queriedFields>Id</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>SFS-7832</description>
        <name>Get_SR</name>
        <label>Get SR</label>
        <locationX>2200</locationX>
        <locationY>276</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Crew_BU_is_null</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>ServiceResource</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>SFL-887</description>
        <name>NewGroupID</name>
        <label>NewGroupID</label>
        <locationX>154</locationX>
        <locationY>1116</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>OldGroupID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>FWBUGroupName.FSM_FieldWorkerPublicGroupAPI__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Group</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>SFL-887</description>
        <name>OldGroupID</name>
        <label>OldGroupID</label>
        <locationX>154</locationX>
        <locationY>1224</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Delete_Old_TS_Shared_record</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>FWBUGroupNameOld.FSM_FieldWorkerPublicGroupAPI__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Group</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_record</name>
        <label>Update record</label>
        <locationX>2068</locationX>
        <locationY>600</locationY>
        <inputAssignments>
            <field>FSM_BusinessUnit__c</field>
            <value>
                <elementReference>Get_SR.FSM_BusinessUnit__c</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>1392</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Check_FSM_BusinessUnit_c_Updated</targetReference>
        </connector>
        <object>ServiceResource</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <scheduledPaths>
            <name>Delete_public_Group_member</name>
            <connector>
                <targetReference>Get_Group</targetReference>
            </connector>
            <label>Delete public Group member</label>
            <offsetNumber>1</offsetNumber>
            <offsetUnit>Minutes</offsetUnit>
            <recordField>FSM_ServiceTerritoryMemberDeletion_Date__c</recordField>
            <timeSource>RecordField</timeSource>
        </scheduledPaths>
        <scheduledPaths>
            <name>Add_BU_for_Crew_after_delay_for_1_Minute</name>
            <connector>
                <targetReference>Get_SR</targetReference>
            </connector>
            <label>Add BU for Crew after delay for 1 Minute</label>
            <offsetNumber>1</offsetNumber>
            <offsetUnit>Minutes</offsetUnit>
            <recordField>CreatedDate</recordField>
            <timeSource>RecordField</timeSource>
        </scheduledPaths>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <subflows>
        <description>SFL-633</description>
        <name>Call_error_log</name>
        <label>Call error log</label>
        <locationX>1100</locationX>
        <locationY>2472</locationY>
        <connector>
            <targetReference>Is_Duration_capacity_or_Travel_restriction_updated</targetReference>
        </connector>
        <flowName>ErrorLog_Subflow_Create_Record</flowName>
        <inputAssignments>
            <name>Actioned</name>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>FSM_ExceptionalNumber</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>FSM_ExternalId</name>
            <value>
                <elementReference>$Record.FSM_ExternalId__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>FSM_FaultMessage</name>
            <value>
                <elementReference>INT009ErrorMessageOnlyWorkCenterUpdated</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>FSM_FlowName</name>
            <value>
                <stringValue>FSM Service Resource - AfterTrigger  </stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>FSM_Type</name>
            <value>
                <stringValue>Field Service</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Interface</name>
            <value>
                <stringValue>INT009</stringValue>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <description>SFL-887</description>
        <name>Call_error_log_Create</name>
        <label>Call error log</label>
        <locationX>418</locationX>
        <locationY>1848</locationY>
        <flowName>ErrorLog_Subflow_Create_Record</flowName>
        <inputAssignments>
            <name>FSM_ExternalId</name>
            <value>
                <elementReference>$Record.FSM_ExternalId__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>FSM_FaultMessage</name>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>FSM_FlowName</name>
            <value>
                <stringValue>FSM Service Resource - AfterTrigger  </stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>FSM_Type</name>
            <value>
                <stringValue>Field Service</stringValue>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <description>SFL-887</description>
        <name>Call_error_log_Del</name>
        <label>Call error log</label>
        <locationX>682</locationX>
        <locationY>1440</locationY>
        <flowName>ErrorLog_Subflow_Create_Record</flowName>
        <inputAssignments>
            <name>FSM_ExternalId</name>
            <value>
                <elementReference>$Record.FSM_ExternalId__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>FSM_FaultMessage</name>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>FSM_FlowName</name>
            <value>
                <stringValue>FSM Service Resource - AfterTrigger  </stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>FSM_Type</name>
            <value>
                <stringValue>Field Service</stringValue>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <name>Call_STM_Record_Creation</name>
        <label>Call STM Record Creation</label>
        <locationX>572</locationX>
        <locationY>2364</locationY>
        <connector>
            <targetReference>Is_Duration_capacity_or_Travel_restriction_updated</targetReference>
        </connector>
        <flowName>FSM_ServiceResourceSubflowCreateSTMRecord</flowName>
        <inputAssignments>
            <name>City</name>
            <value>
                <elementReference>$Record.FSM_City__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Country</name>
            <value>
                <elementReference>$Record.FSM_Country__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>EffectiveStartDate</name>
            <value>
                <elementReference>$Record.FSM_JoiningDate__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>PostCode</name>
            <value>
                <elementReference>$Record.FSM_PostCode__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>ServiceResourceRecord</name>
            <value>
                <elementReference>$Record</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>State</name>
            <value>
                <elementReference>$Record.FSM_County__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Street</name>
            <value>
                <elementReference>$Record.FSM_Street__c</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <name>Call_STM_Record_Creation_1</name>
        <label>Call STM Record Creation</label>
        <locationX>836</locationX>
        <locationY>2472</locationY>
        <connector>
            <targetReference>Is_Duration_capacity_or_Travel_restriction_updated</targetReference>
        </connector>
        <flowName>FSM_ServiceResourceSubflowCreateSTMRecord</flowName>
        <inputAssignments>
            <name>CheckAddressisupdated</name>
            <value>
                <elementReference>Addressisupdated</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>CheckEndDateisUpdated</name>
            <value>
                <elementReference>LeavingDateisUpdated</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>City</name>
            <value>
                <elementReference>$Record.FSM_City__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Country</name>
            <value>
                <elementReference>$Record.FSM_Country__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>EffectiveEndDate</name>
            <value>
                <elementReference>$Record.FSM_LeavingDate__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>EffectiveStartDate</name>
            <value>
                <elementReference>$Record.FSM_STMEffectiveDate__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>PostCode</name>
            <value>
                <elementReference>$Record.FSM_PostCode__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>ServiceResourceRecord</name>
            <value>
                <elementReference>$Record</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>State</name>
            <value>
                <elementReference>$Record.FSM_County__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Street</name>
            <value>
                <elementReference>$Record.FSM_Street__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>WCorBUisUpdated</name>
            <value>
                <elementReference>WCorBUisUpdated</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <description>created as part of sfs-5475</description>
        <name>Update_Service_Territory_Member</name>
        <label>Update Service Territory Member</label>
        <locationX>704</locationX>
        <locationY>2856</locationY>
        <connector>
            <targetReference>Get_Location_and_Parent</targetReference>
        </connector>
        <flowName>FSM_UpdateServiceTerritoryMember</flowName>
        <inputAssignments>
            <name>ServiceResourceRecord</name>
            <value>
                <elementReference>$Record</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <textTemplates>
        <description>SFL-633</description>
        <name>INT009ErrorMessageOnlyWorkCenterUpdated</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>A Service Territory Membership update is required for {!$Record.Name} ({!$Record.FSM_ExternalId__c}). Please update the Effective Date to create new service territory membership for this engineer with the below details, and mark complete once actioned. Please note that Primary Territory Memberships cannot overlap.

Effective Date of Change: {!$Record.FSM_STMEffectiveDate__c}
Work Centre: {!$Record.FSM_WorkCentreExternalId__c}
Start of Work Location: {!$Record.FSM_BaseLocation__c}
Address: City - {!$Record.FSM_City__c}, Post Code - {!$Record.FSM_PostCode__c}, 
Country : {!$Record.FSM_Country__c}, County - {!$Record.FSM_County__c}, 
Street - {!$Record.FSM_Street__c}</text>
    </textTemplates>
    <variables>
        <description>SFl-887</description>
        <name>AllTimeSheetID</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>assignPsg</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Created as a part of SFS-3053</description>
        <name>Location</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Location</objectType>
    </variables>
    <variables>
        <description>Created as part of SFS-3053</description>
        <name>LocationAndParentLocation</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Location</objectType>
    </variables>
    <variables>
        <description>Created as a part of SFS-3053</description>
        <name>ParentLocation</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Location</objectType>
    </variables>
    <variables>
        <description>Created as a part of SFS-3013</description>
        <name>ProductItems</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ProductItem</objectType>
    </variables>
    <variables>
        <name>Psag_Id</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>PsaId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>PsgId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>PsId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>removePsg</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>SFL-887</description>
        <name>SingleTSShareRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>TimeSheetShare</objectType>
    </variables>
    <variables>
        <name>SRrecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <objectType>ServiceResource</objectType>
    </variables>
    <variables>
        <description>SFS-139</description>
        <name>STMUpdatedRecord</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ServiceTerritoryMember</objectType>
    </variables>
    <variables>
        <description>SFL-887</description>
        <name>TimeSheetShareList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>TimeSheetShare</objectType>
    </variables>
</Flow>
